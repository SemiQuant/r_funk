% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/duelSeq.R
\name{analyze_dual_seq}
\alias{analyze_dual_seq}
\title{Analyze and visualize dual-genome sequencing alignment data}
\usage{
analyze_dual_seq(
  flagstat_file,
  primary_genome = "human",
  secondary_genome = "mtb",
  control_sample = "posControl",
  exclude_samples = NULL,
  output_dir = NULL,
  save_plots = FALSE
)
}
\arguments{
\item{flagstat_file}{Path to the MultiQC samtools flagstat file}

\item{primary_genome}{Name of the primary genome (e.g., "human")}

\item{secondary_genome}{Name of the secondary genome (e.g., "mtb")}

\item{control_sample}{Name or pattern of the control sample (e.g., "posControl")}

\item{exclude_samples}{Vector of sample names or patterns to exclude from analysis (e.g., c("negControl", "blank"))}

\item{output_dir}{Directory to save the plots (optional)}

\item{save_plots}{Whether to save the plots to files (default: FALSE)}
}
\value{
A list containing:
\item{alignment_summary}{Plotly object showing alignment distribution}
\item{enrichment}{Plotly object showing enrichment analysis}
\item{combined_plot}{Plotly object with both plots combined}
\item{processed_data}{List containing processed alignment and enrichment data}
}
\description{
This function analyzes dual-genome sequencing alignment data from MultiQC samtools flagstat output.
It generates visualizations showing the distribution of reads between two genomes (e.g., host and pathogen)
and calculates enrichment relative to positive controls. The function produces two plots:
\enumerate{
\item Alignment distribution showing fraction of reads mapping to each genome
\item Enrichment analysis relative to positive control
}
}
